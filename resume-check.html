<!DOCTYPE html>
<html lang="en">
<head>
<title>InternAI — AI Resume Screening</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400;1,500&family=Jost:wght@200;300;400;500;600;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

<style>
/* ═══════════════════════════════════════════
   DESIGN SYSTEM — OBSIDIAN × CHAMPAGNE GOLD
═══════════════════════════════════════════ */
:root {
  --ink:       #050609;
  --deep:      #0b0d14;
  --layer:     #111320;
  --glass:     rgba(255,255,255,0.028);
  --glass2:    rgba(255,255,255,0.05);

  --gold:      #c8a84b;
  --gold2:     #e9cf82;
  --gold3:     #f7e9b8;
  --gold-glow: rgba(200,168,75,0.22);
  --gold-dim:  rgba(200,168,75,0.12);

  --cream:     #f2ede4;
  --muted:     rgba(242,237,228,0.38);
  --muted2:    rgba(242,237,228,0.6);
  --border:    rgba(200,168,75,0.14);
  --border2:   rgba(242,237,228,0.07);

  --green:     #16a34a;
  --green2:    #4ade80;
  --amber:     #d97706;
  --amber2:    #fbbf24;
  --rose:      #be123c;
  --rose2:     #fb7185;
}

*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

html { scroll-behavior: smooth; }

body {
  font-family: 'Jost', sans-serif;
  background: var(--ink);
  color: var(--cream);
  min-height: 100vh;
  overflow-x: hidden;
}

/* ─── AMBIENT BACKGROUND ─── */
.ambient {
  position: fixed; inset: 0;
  pointer-events: none; z-index: 0;
}

.orb {
  position: absolute;
  border-radius: 50%;
  filter: blur(120px);
  animation: drift 18s ease-in-out infinite alternate;
}

.orb-1 {
  width: 700px; height: 700px;
  background: radial-gradient(circle, rgba(200,168,75,0.07), transparent 70%);
  top: -200px; right: -150px;
}

.orb-2 {
  width: 500px; height: 500px;
  background: radial-gradient(circle, rgba(59,49,120,0.07), transparent 70%);
  bottom: -100px; left: -100px;
  animation-delay: -9s;
}

@keyframes drift {
  from { transform: translate(0, 0) scale(1); }
  to   { transform: translate(30px, -20px) scale(1.05); }
}

/* Fine grid */
.grid-bg {
  position: fixed; inset: 0;
  pointer-events: none; z-index: 0;
  background-image:
    linear-gradient(rgba(200,168,75,0.025) 1px, transparent 1px),
    linear-gradient(90deg, rgba(200,168,75,0.025) 1px, transparent 1px);
  background-size: 72px 72px;
}

/* Grain */
.grain {
  position: fixed; inset: 0;
  pointer-events: none; z-index: 0;
  opacity: 0.03;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
}

/* ─── HEADER ─── */
.header {
  position: sticky; top: 0; z-index: 100;
  height: 74px;
  display: flex; align-items: center;
  padding: 0 56px;
  background: rgba(5,6,9,0.82);
  backdrop-filter: blur(28px);
  border-bottom: 1px solid var(--border2);
}

.header::after {
  content: '';
  position: absolute; bottom: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent 5%, var(--gold) 40%, var(--gold2) 60%, transparent 95%);
  opacity: 0.25;
}

.brand {
  display: flex; align-items: center; gap: 14px;
  text-decoration: none;
}

.brand-gem {
  width: 42px; height: 42px;
  background: linear-gradient(135deg, var(--gold), var(--gold2), var(--gold3));
  border-radius: 13px;
  display: flex; align-items: center; justify-content: center;
  font-size: 16px; color: var(--ink);
  box-shadow: 0 0 32px var(--gold-glow);
  animation: gemPulse 3s ease-in-out infinite;
}

@keyframes gemPulse {
  0%, 100% { box-shadow: 0 0 32px var(--gold-glow); }
  50%       { box-shadow: 0 0 52px rgba(200,168,75,0.4), 0 0 90px rgba(200,168,75,0.12); }
}

.brand-name {
  font-family: 'Cormorant Garamond', serif;
  font-size: 24px; font-weight: 500;
  letter-spacing: 0.02em; color: var(--cream);
}

.brand-name em {
  font-style: italic;
  background: linear-gradient(135deg, var(--gold), var(--gold2));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}

.back-btn {
  margin-left: auto;
  display: inline-flex; align-items: center; gap: 7px;
  font-size: 10px; font-weight: 600;
  letter-spacing: 0.22em; text-transform: uppercase;
  color: var(--muted); text-decoration: none;
  transition: color 0.3s;
}
.back-btn:hover { color: var(--gold); }

/* ─── PAGE LAYOUT ─── */
.page {
  position: relative; z-index: 1;
  padding: 72px 24px 100px;
  display: flex; justify-content: center;
}

.container {
  width: 100%; max-width: 780px;
}

/* ─── HERO ─── */
.hero {
  text-align: center;
  margin-bottom: 60px;
  animation: revealUp 0.9s cubic-bezier(0.16,1,0.3,1) both;
}

@keyframes revealUp {
  from { opacity: 0; transform: translateY(32px); }
  to   { opacity: 1; transform: translateY(0); }
}

.eyebrow {
  display: inline-flex; align-items: center; gap: 12px;
  font-size: 9px; font-weight: 700;
  letter-spacing: 0.35em; text-transform: uppercase;
  color: var(--gold); margin-bottom: 22px;
}

.eyebrow::before, .eyebrow::after {
  content: ''; display: block;
  width: 32px; height: 1px;
  background: linear-gradient(90deg, transparent, var(--gold));
}
.eyebrow::after { transform: scaleX(-1); }

.hero h1 {
  font-family: 'Cormorant Garamond', serif;
  font-size: 58px; font-weight: 300;
  letter-spacing: -0.01em; line-height: 1.05;
  margin-bottom: 16px; color: var(--cream);
}

.hero h1 em {
  font-style: italic;
  background: linear-gradient(135deg, var(--gold) 0%, var(--gold2) 55%, var(--gold3) 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}

.hero p {
  font-size: 14.5px; font-weight: 300;
  color: var(--muted); line-height: 1.85;
  max-width: 420px; margin: 0 auto 32px;
}

.hero-stats {
  display: flex; align-items: center;
  justify-content: center; gap: 0;
}

.h-stat {
  padding: 0 32px;
  border-right: 1px solid var(--border2);
  text-align: center;
}
.h-stat:last-child { border-right: none; }

.h-stat-n {
  font-family: 'Cormorant Garamond', serif;
  font-size: 26px; font-weight: 400;
  background: linear-gradient(135deg, var(--gold), var(--gold2));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}

.h-stat-l {
  font-size: 9px; font-weight: 600;
  letter-spacing: 0.2em; text-transform: uppercase;
  color: var(--muted); margin-top: 3px;
}

/* ─── UPLOAD SECTION ─── */
.upload-wrap {
  background: var(--glass);
  border: 1px solid var(--border);
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  animation: revealUp 0.9s cubic-bezier(0.16,1,0.3,1) 0.1s both;
}

/* Gold top rule */
.upload-wrap::before {
  content: '';
  position: absolute; top: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent 10%, var(--gold) 40%, var(--gold2) 60%, transparent 90%);
}

.upload-inner { padding: 44px; }

/* ─── DROP ZONE ─── */
.drop-zone {
  position: relative;
  border: 1.5px dashed rgba(200,168,75,0.3);
  border-radius: 3px;
  padding: 56px 32px;
  text-align: center;
  transition: all 0.35s cubic-bezier(0.16,1,0.3,1);
  background: transparent;
  overflow: hidden;
  cursor: pointer;
}

.drop-zone.drag-over {
  border-color: var(--gold);
  background: var(--gold-dim);
  transform: scale(1.01);
}

.drop-zone.has-file {
  border-color: rgba(200,168,75,0.55);
  background: rgba(200,168,75,0.04);
}

/* hidden input covers zone */
#resumeFile {
  position: absolute;
  inset: 0; opacity: 0;
  width: 100%; height: 100%;
  cursor: pointer;
  z-index: 2;
}

.dz-icon {
  width: 72px; height: 72px;
  margin: 0 auto 20px;
  border: 1px solid var(--border);
  border-radius: 3px;
  display: flex; align-items: center; justify-content: center;
  font-size: 24px; color: var(--gold);
  background: var(--gold-dim);
  position: relative;
  transition: all 0.35s;
}

/* corner accent */
.dz-icon::after {
  content: '';
  position: absolute;
  bottom: -3px; right: -3px;
  width: 7px; height: 7px;
  background: var(--gold);
}

.drop-zone:hover .dz-icon,
.drop-zone.drag-over .dz-icon {
  transform: translateY(-4px);
  box-shadow: 0 16px 40px var(--gold-glow);
  border-color: var(--gold);
}

.dz-title {
  font-family: 'Cormorant Garamond', serif;
  font-size: 22px; font-weight: 400;
  color: var(--cream); letter-spacing: 0.01em;
  margin-bottom: 8px;
}

.dz-sub {
  font-size: 12px; font-weight: 300;
  color: var(--muted); letter-spacing: 0.06em;
  margin-bottom: 20px;
}

.dz-formats {
  display: inline-flex; gap: 8px;
}

.fmt-tag {
  padding: 3px 12px;
  border: 1px solid var(--border);
  border-radius: 2px;
  font-size: 10px; font-weight: 600;
  letter-spacing: 0.15em; text-transform: uppercase;
  color: var(--muted);
}

/* ─── FILE PREVIEW ─── */
.file-preview {
  display: none;
  align-items: center; gap: 14px;
  margin-top: 18px;
  padding: 14px 18px;
  background: rgba(200,168,75,0.06);
  border: 1px solid rgba(200,168,75,0.2);
  border-radius: 3px;
}

.file-preview.show { display: flex; animation: revealUp 0.4s ease both; }

.fp-icon {
  width: 38px; height: 38px; flex-shrink: 0;
  background: var(--gold-dim);
  border: 1px solid var(--border);
  border-radius: 2px;
  display: flex; align-items: center; justify-content: center;
  font-size: 15px; color: var(--gold);
}

.fp-info { flex: 1; min-width: 0; }
.fp-name {
  font-size: 13px; font-weight: 500;
  color: var(--cream);
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.fp-size { font-size: 11px; color: var(--muted); margin-top: 2px; }

.fp-remove {
  width: 28px; height: 28px;
  border: 1px solid var(--border2);
  border-radius: 2px;
  background: transparent;
  color: var(--muted); font-size: 11px;
  cursor: pointer; display: flex;
  align-items: center; justify-content: center;
  transition: 0.25s;
}
.fp-remove:hover { border-color: var(--rose2); color: var(--rose2); }

/* ─── DIVIDER ─── */
.up-divider {
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--border), transparent);
  margin: 28px 0;
}

/* ─── SUBMIT BTN ─── */
.btn-screen {
  width: 100%; padding: 17px 24px;
  background: transparent;
  border: 1px solid var(--gold);
  border-radius: 2px;
  font-family: 'Jost', sans-serif;
  font-size: 10px; font-weight: 700;
  letter-spacing: 0.3em; text-transform: uppercase;
  color: var(--gold); cursor: pointer;
  position: relative; overflow: hidden;
  transition: color 0.4s;
  display: flex; align-items: center; justify-content: center; gap: 10px;
}

.btn-screen::before {
  content: '';
  position: absolute; inset: 0;
  background: linear-gradient(135deg, var(--gold), var(--gold2));
  transform: scaleX(0); transform-origin: left;
  transition: transform 0.45s cubic-bezier(0.16,1,0.3,1);
}

.btn-screen:hover:not(:disabled) { color: var(--ink); }
.btn-screen:hover:not(:disabled)::before { transform: scaleX(1); }

.btn-screen:disabled {
  opacity: 0.4; cursor: not-allowed;
  border-color: var(--border2); color: var(--muted);
}

.btn-screen span, .btn-screen i { position: relative; z-index: 1; }

/* ─── STATUS ─── */
.status-row {
  margin-top: 24px;
  min-height: 28px;
  display: flex; align-items: center; justify-content: center; gap: 10px;
}

.spin-ring {
  width: 20px; height: 20px;
  border: 2px solid rgba(200,168,75,0.2);
  border-top-color: var(--gold);
  border-radius: 50%;
  animation: spin 0.7s linear infinite;
  display: none;
}
.spin-ring.active { display: block; }
@keyframes spin { to { transform: rotate(360deg); } }

.status-txt {
  font-size: 12px; font-weight: 400;
  letter-spacing: 0.12em; color: var(--gold2);
}

/* ─── RESULTS ─── */
.results { margin-top: 32px; display: flex; flex-direction: column; gap: 20px; }

.result-card {
  background: var(--glass);
  border: 1px solid var(--border);
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  animation: revealUp 0.6s cubic-bezier(0.16,1,0.3,1) both;
}

.result-card::before {
  content: '';
  position: absolute; top: 0; left: 0; right: 0; height: 1px;
  background: linear-gradient(90deg, transparent, var(--gold), transparent);
  opacity: 0.4;
}

.rc-header {
  padding: 20px 28px 0;
  display: flex; align-items: center; gap: 10px;
  font-size: 8.5px; font-weight: 700;
  letter-spacing: 0.3em; text-transform: uppercase;
  color: rgba(200,168,75,0.6);
}

.rc-header::after {
  content: ''; flex: 1; height: 1px;
  background: linear-gradient(90deg, var(--border), transparent);
}

.rc-body { padding: 20px 28px 28px; }

/* SCORE SECTION */
.score-layout {
  display: flex; align-items: center; gap: 36px;
}

.score-ring-wrap {
  position: relative;
  width: 130px; height: 130px; flex-shrink: 0;
}

.score-ring-wrap svg {
  width: 130px; height: 130px;
  transform: rotate(-90deg);
}

.sr-track {
  fill: none;
  stroke: rgba(255,255,255,0.07);
  stroke-width: 8;
}

.sr-fill {
  fill: none;
  stroke-width: 8;
  stroke-linecap: round;
  stroke-dasharray: 339.3;
  stroke-dashoffset: 339.3;
  transition: stroke-dashoffset 1.4s cubic-bezier(0.4,0,0.2,1);
}

.score-num {
  position: absolute; inset: 0;
  display: flex; align-items: center; justify-content: center;
  flex-direction: column;
}

.score-val {
  font-family: 'Cormorant Garamond', serif;
  font-size: 32px; font-weight: 400;
  line-height: 1;
}

.score-lbl {
  font-size: 8px; font-weight: 600;
  letter-spacing: 0.2em; text-transform: uppercase;
  color: var(--muted); margin-top: 3px;
}

.score-info { flex: 1; }

.score-grade {
  font-family: 'Cormorant Garamond', serif;
  font-size: 28px; font-weight: 400;
  letter-spacing: 0.02em; margin-bottom: 8px;
}

.score-desc {
  font-size: 13px; font-weight: 300;
  color: var(--muted); line-height: 1.7;
}

.score-bar-wrap {
  margin-top: 16px;
  height: 3px;
  background: rgba(255,255,255,0.07);
  border-radius: 2px; overflow: hidden;
}

.score-bar-fill {
  height: 100%; border-radius: 2px;
  transition: width 1.5s cubic-bezier(0.4,0,0.2,1);
  width: 0;
}

/* SKILLS GRID */
.skills-grid { display: flex; flex-wrap: wrap; gap: 10px; }

.s-pill {
  display: inline-flex; align-items: center; gap: 7px;
  padding: 6px 15px;
  border-radius: 2px;
  font-size: 12px; font-weight: 500;
  letter-spacing: 0.04em;
  border: 1px solid; transition: 0.25s;
  cursor: default;
}

.s-pill.matched {
  background: rgba(22,163,74,0.08);
  border-color: rgba(74,222,128,0.2);
  color: var(--green2);
}
.s-pill.matched:hover {
  background: rgba(22,163,74,0.15);
  transform: translateY(-1px);
}
.s-pill.matched i { font-size: 9px; color: var(--green2); }

.s-pill.missing {
  background: rgba(190,18,60,0.07);
  border-color: rgba(251,113,133,0.2);
  color: var(--rose2);
}
.s-pill.missing:hover {
  background: rgba(190,18,60,0.14);
  transform: translateY(-1px);
}
.s-pill.missing i { font-size: 9px; color: var(--rose2); }

/* RECOMMENDATION */
.reco-box {
  padding: 20px 22px;
  background: rgba(200,168,75,0.04);
  border: 1px solid var(--border);
  border-left: 2px solid var(--gold);
  border-radius: 2px;
  font-size: 13px; font-weight: 300;
  color: var(--muted2); line-height: 1.8;
}

/* ─── FOOTER ─── */
.footer {
  position: relative; z-index: 1;
  margin-top: 80px; padding: 28px 56px;
  border-top: 1px solid var(--border2);
  display: flex; align-items: center; justify-content: space-between;
  background: rgba(5,6,9,0.5);
  backdrop-filter: blur(20px);
  font-size: 11px; color: var(--muted);
}

.footer-brand {
  font-family: 'Cormorant Garamond', serif;
  font-size: 17px; font-weight: 400; color: var(--cream);
}
.footer-brand em {
  font-style: italic;
  background: linear-gradient(135deg, var(--gold), var(--gold2));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}

/* ─── RESPONSIVE ─── */
@media (max-width: 700px) {
  .header { padding: 0 24px; }
  .upload-inner { padding: 28px 22px; }
  .hero h1 { font-size: 38px; }
  .score-layout { flex-direction: column; align-items: flex-start; gap: 20px; }
  .footer { flex-direction: column; gap: 10px; text-align: center; padding: 24px; }
  .h-stat { padding: 0 18px; }
}
</style>
</head>

<body>

<!-- AMBIENT -->
<div class="ambient">
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
</div>
<div class="grid-bg"></div>
<div class="grain"></div>

<!-- HEADER -->
<header class="header">
  <a class="brand" href="student-dashboard.html">
    <div class="brand-gem"><i class="fas fa-brain"></i></div>
    <div class="brand-name">Intern<em>AI</em></div>
  </a>
  <a class="back-btn" href="internships.html">
    <i class="fas fa-arrow-left"></i> Back to Listings
  </a>
</header>

<!-- PAGE -->
<div class="page">
  <div class="container">

    <!-- HERO -->
    <div class="hero">
      <div class="eyebrow">AI-Powered Analysis</div>
      <h1>Resume <em>Screening</em></h1>
      <p>Upload your résumé and receive an instant AI-powered compatibility report against this internship opening.</p>
      <div class="hero-stats">
        <div class="h-stat">
          <div class="h-stat-n">5K+</div>
          <div class="h-stat-l">Resumes</div>
        </div>
        <div class="h-stat">
          <div class="h-stat-n">98%</div>
          <div class="h-stat-l">Accuracy</div>
        </div>
        <div class="h-stat">
          <div class="h-stat-n">2.4×</div>
          <div class="h-stat-l">Faster</div>
        </div>
      </div>
    </div>

    <!-- UPLOAD CARD -->
    <div class="upload-wrap">
      <div class="upload-inner">

        <!-- DROP ZONE -->
        <div class="drop-zone" id="dropZone">
          <input type="file" id="resumeFile" accept=".pdf,.doc,.docx">

          <div class="dz-icon"><i class="fas fa-file-arrow-up"></i></div>
          <div class="dz-title">Drop your résumé here</div>
          <div class="dz-sub">or click anywhere to browse your files</div>
          <div class="dz-formats">
            <span class="fmt-tag">PDF</span>
            <span class="fmt-tag">DOC</span>
            <span class="fmt-tag">DOCX</span>
          </div>
        </div>

        <!-- FILE PREVIEW -->
        <div class="file-preview" id="filePreview">
          <div class="fp-icon"><i class="fas fa-file-lines"></i></div>
          <div class="fp-info">
            <div class="fp-name" id="fpName">—</div>
            <div class="fp-size" id="fpSize">—</div>
          </div>
          <button class="fp-remove" id="fpRemove" title="Remove file">
            <i class="fas fa-times"></i>
          </button>
        </div>

        <div class="up-divider"></div>

        <!-- SUBMIT -->
        <button class="btn-screen" id="checkBtn" onclick="uploadResume()" disabled>
          <i class="fas fa-microchip"></i>
          <span id="btnTxt">Run AI Screening</span>
        </button>
      </div>
    </div>

    <!-- STATUS -->
    <div class="status-row">
      <div class="spin-ring" id="spinner"></div>
      <div class="status-txt" id="statusTxt"></div>
    </div>

    <!-- RESULTS -->
    <div class="results" id="results"></div>

  </div>
</div>

<!-- FOOTER -->
<footer class="footer">
  <div class="footer-brand">Intern<em>AI</em></div>
  <div>© 2026 InternAI · Smart Career Growth Powered by AI</div>
</footer>

<script>
const BASE_URL = "https://aiinternship-backend-7.onrender.com";

const params       = new URLSearchParams(window.location.search);
const internshipId = params.get("internshipId");
let resumeId = null;
let selectedFile = null;

const fileInput   = document.getElementById("resumeFile");
const dropZone    = document.getElementById("dropZone");
const filePreview = document.getElementById("filePreview");
const fpName      = document.getElementById("fpName");
const fpSize      = document.getElementById("fpSize");
const fpRemove    = document.getElementById("fpRemove");
const checkBtn    = document.getElementById("checkBtn");
const btnTxt      = document.getElementById("btnTxt");
const spinner     = document.getElementById("spinner");
const statusTxt   = document.getElementById("statusTxt");
const results     = document.getElementById("results");

function formatBytes(bytes) {
  if (bytes < 1024) return bytes + ' B';
  if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' KB';
  return (bytes / 1048576).toFixed(2) + ' MB';
}

function setFile(file) {
  if (!file) return;
  selectedFile = file;
  fpName.textContent = file.name;
  fpSize.textContent = formatBytes(file.size);
  filePreview.classList.add("show");
  dropZone.classList.add("has-file");
  checkBtn.disabled = false;
}

function clearFile() {
  selectedFile = null;
  fileInput.value = "";
  filePreview.classList.remove("show");
  dropZone.classList.remove("has-file");
  checkBtn.disabled = true;
  results.innerHTML = "";
  setStatus("", false);
}

fileInput.addEventListener("change", function () {
  if (this.files && this.files[0]) setFile(this.files[0]);
});

fpRemove.addEventListener("click", function (e) {
  e.stopPropagation();
  clearFile();
});

dropZone.addEventListener("dragover", e => {
  e.preventDefault();
  dropZone.classList.add("drag-over");
});

dropZone.addEventListener("dragleave", () => {
  dropZone.classList.remove("drag-over");
});

dropZone.addEventListener("drop", function (e) {
  e.preventDefault();
  dropZone.classList.remove("drag-over");
  const file = e.dataTransfer.files[0];
  if (file) {
    const dt = new DataTransfer();
    dt.items.add(file);
    fileInput.files = dt.files;
    setFile(file);
  }
});

function setStatus(msg, loading) {
  statusTxt.textContent = msg;
  loading ? spinner.classList.add("active") : spinner.classList.remove("active");
}

function uploadResume() {
  if (!selectedFile) {
    alert("Please select your résumé first.");
    return;
  }

  if (!internshipId) {
    alert("Internship ID missing in URL.");
    return;
  }

  checkBtn.disabled = true;
  btnTxt.textContent = "Uploading…";
  setStatus("Uploading résumé...", true);
  results.innerHTML = "";

  const formData = new FormData();
  formData.append("file", selectedFile);
  formData.append("email", "student@test.com");
  formData.append("cgpa", "8.0");

  fetch(`${BASE_URL}/api/resume/upload`, {
    method: "POST",
    body: formData
  })
  .then(r => r.json())
  .then(d => {
    resumeId = d.id ?? d.resumeId;
    btnTxt.textContent = "Analysing…";
    setStatus("Running AI analysis...", true);
    return fetch(
      `${BASE_URL}/api/resume/predict?resumeId=${resumeId}&internshipId=${internshipId}`,
      { method: "POST" }
    );
  })
  .then(r => r.json())
  .then(d => {
    setStatus("", false);
    checkBtn.disabled = false;
    btnTxt.textContent = "Run AI Screening";
    renderResult(d);
  })
  .catch(err => {
    console.error(err);
    setStatus("Something went wrong.", false);
    checkBtn.disabled = false;
    btnTxt.textContent = "Run AI Screening";
  });
}

function renderResult(d) {
  const pct = Math.min(100, Math.max(0, d.matchPercentage ?? 0));
  const matched = d.matchedSkills ?? [];
  const missing = d.missingSkills ?? [];

  let grade, desc, colour;

  if (pct >= 75) {
    grade = "Strong Match";
    desc = "Your profile is well-aligned with this internship.";
    colour = "#4ade80";
  } else if (pct >= 45) {
    grade = "Moderate Match";
    desc = "You meet several key requirements.";
    colour = "#fbbf24";
  } else {
    grade = "Low Match";
    desc = "Your profile needs improvement for this role.";
    colour = "#fb7185";
  }

  results.innerHTML = `
    <div class="result-card">
      <div class="rc-body">
        <h3 style="color:${colour}">${grade} — ${pct}%</h3>
        <p>${desc}</p>
        <br>
        <strong>Matched Skills:</strong><br>
        ${matched.join(", ") || "None"}<br><br>
        <strong>Missing Skills:</strong><br>
        ${missing.join(", ") || "None"}
      </div>
    </div>
  `;
}
</script>

</body>
</html>